# 差旅数据分析工具

纯前端差旅数据处理、分析和查询工具，帮助业务部门负责人掌握销售人员的差旅情况。

## 功能特性

- 📊 **数据源管理**: 支持4个Excel文件（花名册 + 阿里/携程/在途商旅数据）
- 🔍 **智能筛选**: 按一级部门筛选，支持时间范围、类型、员工搜索
- 📈 **数据可视化**: 趋势图、类型分布、员工排名、部门对比
- 🗂️ **分类型展示**: 机票/酒店/火车/用车独立Tab，全字段展示
- 🔐 **部门安全**: 默认显示教培业务中心，切换部门需要密码
- 📄 **数据导出**: 支持导出当前筛选结果为CSV

## 快速开始

### 1. 安装依赖

```bash
pip install -r requirements.txt
```

### 2. 放置数据文件

将Excel文件放入 `data/raw/` 目录：

```
data/raw/
├── 2025年12月花名册.xlsx
├── 阿里20251125-20251224.xlsx
├── 携程20251126-20251225.xlsx
└── 在途20251126-20251225.xls
```

### 3. 运行

```bash
./start.sh
```

脚本会自动：
- 检测数据文件变化
- 处理数据并生成JSON
- 生成HTML文件
- 在浏览器中打开

## 文件命名规范

### 花名册
- 格式：`*花名册*.xlsx`
- 示例：`2025年12月花名册.xlsx`
- 提取：姓名、英文名、一级部门、二级部门、三级部门、岗位、在职状态

### 阿里商旅
- 格式：`阿里*.xlsx`
- 示例：`阿里20251125-20251224.xlsx`
- 日期范围：`YYYYMMDD-YYYYMMDD`

### 携程商旅
- 格式：`携程*.xlsx`
- 示例：`携程20251126-20251225.xlsx`
- 日期范围：`YYYYMMDD-YYYYMMDD`

### 在途商旅
- 格式：`在途*.xls`
- 示例：`在途20251126-20251225.xls`
- 日期范围：`YYYYMMDD-YYYYMMDD`

## 部门安全说明

- **默认部门**: 教培业务中心
- **切换密码**: 201212
- 解锁后可切换到其他部门或查看全部数据

## 项目结构

```
Travel-cost/
├── data/
│   ├── raw/                   # 原始Excel文件（用户放置）
│   └── processed/             # 处理后的JSON
├── scripts/                   # Python脚本
│   ├── utils/                 # 工具模块
│   ├── process_*.py           # 数据处理脚本
│   ├── merge_data.py          # 数据合并
│   ├── process_all.py         # 一键处理
│   └── generate_html.py       # HTML生成
├── templates/                 # HTML模板
│   ├── travel-analysis.html   # 主HTML
│   ├── styles.css             # 样式
│   └── app.js                 # 前端逻辑
├── output/                    # 输出目录
├── start.sh                   # 启动脚本
└── requirements.txt           # Python依赖
```

## 使用场景

### 日常使用
1. 将新的Excel文件复制到 `data/raw/`
2. 运行 `./start.sh`
3. 脚本自动处理并在浏览器中打开

### 分发给部门负责人
```bash
# 将生成的HTML发送给各部门
cp output/travel-analysis.html ~/Desktop/技术部差旅数据.html
```

部门负责人双击打开即可查看。

## 技术栈

- **后端**: Python (pandas, openpyxl, xlrd)
- **前端**: 原生HTML/CSS/JavaScript
- **图表**: ECharts
- **日期**: Day.js

## 数据字段

### 机票
- 乘机人、预定时间、航班号、起飞时间、出发地、目的地、票价、舱位类型、航空公司

### 酒店
- 员工、入住时间、离开时间、城市、区县、酒店名称、房型、房价、是否合住

### 火车
- 员工、车次、座席、发车时间、出发城市、到达城市、票价

### 用车
- 乘车人、上车时间、下车时间、用车类型、服务方、出发地、目的地、里程、金额
